sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,t){"use strict";return{createDeviceModel:function(){var r=new e(t);r.setDefaultBindingMode("OneWay");return r},oDataConsultODATA:function(e,t,r,n,o,i){try{OData.defaultHttpClient.enableJsonpCallback=true;var s={};var a="";var c={headers:s,requestUri:a,method:e};var u="";var f="";a="/drizzle/DRIZZLE_GLOBAL_SRV"+t;var d=new Promise(function(t,i){switch(e){case"GET":if(n.length>0&&o==="1"){f="";c.url=a+"?$";for(var u=0;u<n.length;u++){f=n[u].sPath+" "+n[u].sOperator+" "+typeof n[u].oValue1==="string"?"'"+n[u].oValue1+"'":String(n[u].oValue1)+" and "+f}var d=f.lastIndexOf("and");f.substring(0,d);c.url=c+f;OData.read(c,function(e){t(e)},function(e){i(e)})}else if(o==="1"){OData.read(c,function(e){t(e)},function(e){i(e)})}else if(n.length>0&&o==="2"){c.url=a+"?$";f="";c.url=a+"?$";for(var u=0;u<n.length;u++){f=n[u].sPath+" "+n[u].sOperator+" "+typeof n[u].oValue1==="string"?"'"+n[u].oValue1+"'":String(n[u].oValue1)+" and "+f}d=f.lastIndexOf("and");f.substring(0,d);c.url=c+f;OData.read(c,function(e){var n=[];n.push(e);n.push(r);t(n)},function(e){i(e)})}break;case"POST":s["Content-Type"]="application/json";s["accept"]="application/json";s["If-Match"]="*";c.headers=s;c.data=r;OData.request(c,function(e){t(e)},function(e){i(e)});break;default:}});return d}catch(e){i.getMessageBox("error",i.getI18nText("error"));$.oLog.push({error:e,date:new Date})}},oDataConsult:function(e,t,r,n,o,i,s){try{return new Promise(function(a,c){if(typeof sap.hybrid!=="undefined"&&navigator.onLine){switch(e){case"read":if(s!=undefined){i.getModel("drizzleOD").read(t,{filters:n,urlParameters:s,success:function(e){a(e)},error:function(e){c(e)}})}else if(n.length>0&&o==="1"){i.getModel("drizzleOD").read(t,{filters:n,success:function(e){a(e)},error:function(e){c(e)}})}else if(o==="1"){i.getModel("drizzleOD").read(t,{success:function(e){a(e)},error:function(e){c(e)}})}else if(n.length>0&&o==="2"){i.getModel("drizzleOD").read(t,{filters:n,success:function(e){var t=[];t.push(e);t.push(r);a(t)},error:function(e){c(e)}})}break;case"create":i.getModel("drizzleOD").create(t,r,{success:function(e){a(e)},error:function(e){c(e)}});break;default:}}else{switch(e){case"read":if(s!==undefined&&s!==""){i.oModel[e](t,{filters:n,urlParameters:s,success:function(e){a(e)},error:function(e){c(e)}})}else if(n.length>0&&o==="1"){i.oModel[e](t,{filters:n,success:function(e){a(e)},error:function(e){c(e)}})}else if(o==="1"){i.oModel[e](t,{success:function(e){a(e)},error:function(e){c(e)}})}else if(n.length>0&&o==="2"){i.oModel[e](t,{filters:n,success:function(e){var t=[];t.push(e);t.push(r);a(t)},error:function(e){c(e)}})}break;case"create":i.oModel[e](t,r,{success:function(e){a(e)},error:function(e){c(e)}});break;default:}}})}catch(e){i.getMessageBox("error",i.getI18nText("error"));$.oLog.push({error:e,date:new Date})}},oFTP:function(e,t,r,n,o,i,s){try{return new Promise(function(s,a){if(typeof sap.hybrid!=="undefined"&&navigator.onLine){switch(e){case"read":if(n.length>0&&o==="1"){i.getModel("drizzleOD").read(t,{filters:n,success:function(e){s(e)},error:function(e){a(e)}})}else if(o==="1"){i.getModel("drizzleOD").read(t,{success:function(e){s(e)},error:function(e){a(e)}})}break;case"create":if(o==="1"){i.getModel("drizzleOD").create(t,r,{success:function(e){s(e)},error:function(e){a(e)}})}else if(o==="2"){i.getModel("drizzleOD").create(t,r,{success:function(e){s(e)},error:function(e){a(e)}})}break;default:}}else{switch(e){case"read":if(n.length>0&&o==="1"){i.oModel[e](t,{filters:n,success:function(e){s(e)},error:function(e){a(e)}})}else if(o==="1"){i.oModel[e](t,{success:function(e){s(e)},error:function(e){a(e)}})}break;case"create":if(o==="1"){i.oModel[e](t,r,{success:function(e){s(e)},error:function(e){a(e)}})}else if(o==="2"){i.oModel[e](t,r,{success:function(e){s(e)},error:function(e){a(e)}})}break;default:}}})}catch(e){i.getMessageBox("error",i.getI18nText("error"));$.oLog.push({error:e,date:new Date})}},http:function(e){var t={ajax:function(e,t,r,n){var o=new Promise(function(o,i){var s=new XMLHttpRequest;var a=t;if(n&&e==="GET"){a+="?";var c=0;for(var u in n){if(n.hasOwnProperty(u)){if(c++){a+="&"}a+=encodeURIComponent(u)+"="+encodeURIComponent(n[u])}}}s.open(e,a,true);if(n&&(e==="POST"||e==="PUT")){var f=n}for(var d in r){if(r.hasOwnProperty(d)){s.setRequestHeader(d,r[d])}}if(f){s.send(f instanceof FormData?f:JSON.stringify(f))}else{s.send()}s.onload=function(){if(this.status==200||this.status==201){try{o(JSON.parse(this.response))}catch(e){o(this.response)}}else{i(this)}};s.onerror=function(){i(this)}});return o}};return{get:function(r,n){return t.ajax("GET",e,r,n)},post:function(r,n){return t.ajax("POST",e,r,n)},put:function(r,n){return t.ajax("PUT",e,r,n)},delete:function(r,n){return t.ajax("DELETE",e,r,n)}}},createFolder:function(e,t){var r=new FormData;r.append("cmisaction","createFolder");r.append("propertyId[0]","cmis:objectTypeId");r.append("propertyValue[0]","cmis:folder");r.append("propertyId[1]","cmis:name");r.append("propertyValue[1]",e);if(t==="2"){return this.getRepoId().then(function(e){return this.http("/drizzleDS/cmis/json/"+e+"/root/DRIZZLE").post(false,r)})}if(t==="1"){var n=this;return new Promise(function(e,t){try{n.getRepoId().then(function(t){e(n.http("/drizzleDS/cmis/json/"+t+"/root").post(false,r))})}catch(e){t(e)}})}},uploadFile:function(e,t){var r=new FormData;r.append("datafile",e.FileBase64);r.append("cmisaction","createDocument");r.append("propertyId[0]","cmis:objectTypeId");r.append("propertyValue[0]","cmis:document");r.append("propertyId[1]","cmis:name");r.append("propertyValue[1]",e.Filename);return this.getRepoId().then(function(e){return this.http("/drizzleDS/cmis/json/"+e+"/root/"+$.FolderPrincipal+"/"+t).post(false,r)}.bind(this))},deleteFile:function(e){var t=new FormData;t.append("cmisaction","delete");return this.getRepoId().then(function(r){return this.http("/drizzleDS/cmis/json/"+r+"/root/"+$.FolderPrincipal+"/"+e).post(false,t)}.bind(this))},getFiles:function(){return this.getRepoId().then(function(e){return this.http("/drizzleDS/cmis/json/"+e+"/root/").get()}.bind(this))},getRepoId:function(){if(this.RepoId){return Promise.resolve(this.RepoId)}return this.getRepoInfo().then(function(e){for(var t in e){this.ReposId=e[t].repositoryId;break}return this.ReposId}.bind(this))},getRepoInfo:function(){return this.http("/drizzleDS/cmis/json").get()}}});