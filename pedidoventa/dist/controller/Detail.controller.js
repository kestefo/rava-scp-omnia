sap.ui.define(["sap/ui/core/mvc/Controller","com/rava/pedido/pedidoventa/controller/BaseController","com/rava/pedido/pedidoventa/model/models"],function(e,t,o){"use strict";var a,r=false;return t.extend("com.rava.pedido.pedidoventa.controller.Detail",{onInit:function(){a=this;this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.oRouter.getTarget("Detail").attachDisplay(jQuery.proxy(this.handleRouteMatched,this));this.frgIdAddProducto="frgIdAddProducto";this.frgIdLoadMasive="frgIdLoadMasive";this.frgIdAddEan="frgIdAddEan";console.log("init")},handleRouteMatched:function(){Promise.all([]).then(async e=>{this.oModelPedidoVenta=this.getModel("oModelPedidoVenta");this.oModelPedidoVenta.setProperty("/AddSelectFamilia",o.JsonFamilia());var t=o.JsonProductos();var r=this._byId("siContador").getValue();this.oModelPedidoVenta.setProperty("/ProductoCreados",t.slice(0,r));var d=t.length;var i=d/r;var s=i%1==0;var n=0;if(s==true){n=i}else{n=parseInt(i)+1}var l=new sap.ui.commons.Paginator({visible:true,numberOfPages:n,page:function(e){var t=e.getParameter("targetPage");var d=t*r;var i=d-r;var s=o.JsonProductos();var n=s.slice(i,d);a.oModelPedidoVenta.setProperty("/ProductoCreados",n)}});var c=new sap.m.VBox({alignItems:"Center",items:[l]});this._byId("vbTableDetalle").addItem(c)}).catch(function(e){sap.ui.core.BusyIndicator.hide(0)})},_onPressNavButtonDetail:function(){this.oRouter.navTo("Main")},_onPressAddProductPro:function(){this.oModelPedidoVenta.setProperty("/visibleTable",false);this.setFragment("_dialogAddProducto",this.frgIdAddProducto,"AddProducto",this)},_onChangeFamilia:function(){this.oModelPedidoVenta.setProperty("/visibleTable",true);this.oModelPedidoVenta.setProperty("/ProductoFamilia",o.JsonProductoFamilia())},_onLiveChangeCantidad:function(e){var t=e.getSource();var o=t.getParent();var a=t.getParent().getBindingContext("oModelPedidoVenta");var r=a.getObject();r.state="Success";r.icon="sap-icon://inbox";this.getModel("oModelPedidoVenta").refresh()},_onChangeCounter:function(e){var t=e.getSource();var r=t.getValue();var d=this._byId("tbProductos");var i=o.JsonProductos();this._byId("vbTableDetalle").removeItem(1);this.oModelPedidoVenta.setProperty("/ProductoCreados",i.slice(0,r));var s=i.length;var n=s/r;var l=n%1==0;var c=0;if(l==true){c=n}else{c=parseInt(n)+1}var u=new sap.ui.commons.Paginator({visible:true,numberOfPages:c,page:function(e){var t=e.getParameter("targetPage");var d=t*r;var i=d-r;var s=o.JsonProductos();var n=s.slice(i,d);a.oModelPedidoVenta.setProperty("/ProductoCreados",n)}});var v=new sap.m.VBox({alignItems:"Center",items:[u]});this._byId("vbTableDetalle").addItem(v)},_onPressLoadMasive:function(){var e={HTML:"<p>"+this.getI18nText("textSegundoCarga")+'<a href="//www.sap.com" style="color:blue; font-weight:600;">'+this.getI18nText("textTerceroCarga")+"</a> "+this.getI18nText("textCuartoCarga")+"</p>"};this.oModelPedidoVenta.setProperty("/textHtml",e);this.setFragment("_dialogLoadMasive",this.frgIdLoadMasive,"LoadMasive",this)},_onPressAddEan:function(){this.setFragment("_dialogAddEan",this.frgIdAddEan,"AddEan",this)}})});